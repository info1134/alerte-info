<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>info11 le retour</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #f5f6fa;
      margin: 0;
      padding: 0;
      font-size: 16px;
      color: #222;
      transition: background 0.3s, color 0.3s;
    }
    header {
      background: #2c3e50;
      color: #fff;
      padding: 20px 0;
      margin-bottom: 30px;
      box-shadow: 0 2px 8px #0001;
      display: flex;
      justify-content: center;
    }
    header .container {
      max-width: 900px;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 10px;
    }
    header h1 {
      margin: 0;
      font-size: 2rem;
      letter-spacing: 2px;
    }
    header span {
      font-style: italic;
      font-size: 1.1rem;
      color: #ddd;
    }
    #darkToggle {
      margin-left: 30px;
      padding: 6px 16px;
      border-radius: 15px;
      border: none;
      background: #fff;
      color: #2c3e50;
      font-weight: 600;
      cursor: pointer;
      user-select: none;
      transition: background 0.3s, color 0.3s;
      flex-shrink: 0;
    }
    .form-box {
      background: #fff;
      max-width: 480px;
      margin: auto;
      padding: 30px 32px 22px 32px;
      border-radius: 8px;
      box-shadow: 0 4px 16px #0001;
      transition: background 0.3s, color 0.3s;
    }
    .form-box h2 {
      margin: 0 0 20px 0;
      font-size: 1.3rem;
      color: #2c3e50;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-size: 1rem;
      color: #222;
    }
    select,
    input,
    textarea {
      width: 100%;
      padding: 10px 8px;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin-bottom: 16px;
      font-size: 1rem;
      transition: background 0.3s, color 0.3s, border-color 0.3s;
      resize: vertical;
    }
    select:focus,
    input:focus,
    textarea:focus {
      outline: none;
      border-color: #e74c3c;
      box-shadow: 0 0 6px #e74c3caa;
    }
    .button-pro {
      background: #e74c3c;
      color: #fff;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      font-size: 1.1rem;
      cursor: pointer;
      transition: background 0.2s;
      width: 100%;
      margin-bottom: 10px;
      user-select: none;
    }
    .button-pro:hover,
    .button-pro:focus {
      background: #c0392b;
      outline: none;
    }
    #confirmation {
      display: none;
      margin: 10px 0;
      color: green;
      font-weight: 500;
    }
    .table-section {
      max-width: 900px;
      margin: 38px auto;
      background: #fff;
      padding: 18px 25px 25px 25px;
      border-radius: 8px;
      box-shadow: 0 4px 16px #0001;
      transition: background 0.3s, color 0.3s;
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      color: inherit;
      background: transparent;
    }
    th,
    td {
      padding: 10px;
      border-bottom: 1px solid #eee;
      text-align: left;
      max-width: 250px;
      word-break: break-word;
    }
    th {
      background: #eee;
      color: #2c3e50;
    }
    #compteur {
      display: block;
      margin-bottom: 10px;
      color: #666;
      font-size: 0.98rem;
    }
    /* Dark mode styles */
    .darkmode {
      background: #20242c !important;
      color: #f5f6fa;
    }
    .darkmode header {
      background: #131821;
      box-shadow: 0 2px 12px #000c;
    }
    .darkmode #darkToggle {
      background: #2c3e50;
      color: #f5f6fa;
      border: 1px solid #4a5a78;
    }
    .darkmode .form-box,
    .darkmode .table-section {
      background: #263040;
      color: #f5f6fa;
    }
    .darkmode select,
    .darkmode input,
    .darkmode textarea {
      background: #18202d;
      color: #f5f6fa;
      border: 1px solid #444;
    }
    .darkmode select:focus,
    .darkmode input:focus,
    .darkmode textarea:focus {
      border-color: #e74c3c;
      box-shadow: 0 0 6px #e74c3caa;
    }
    .darkmode th {
      background: #111b27;
      color: #f5f6fa;
    }
    /* Responsive */
    @media (max-width: 600px) {
      .form-box,
      .table-section {
        max-width: 98vw;
        padding: 16px;
      }
      header .container {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }
      #darkToggle {
        margin-left: 0;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>info11 le retour</h1>
      <span aria-label="Slogan du site">L‚Äôalerte simple & rapide</span>
      <button id="darkToggle" aria-pressed="false" aria-label="Basculer en mode sombre" tabindex="0">üåô Mode sombre</button>
    </div>
  </header>

  <main>
    <div class="form-box" role="region" aria-labelledby="form-title">
      <h2 id="form-title">Publier une nouvelle alerte</h2>

      <form onsubmit="return validerAlerte();" aria-describedby="form-desc">
        <p id="form-desc" style="display:none;">Formulaire pour publier une nouvelle alerte citoyenne.</p>

        <label for="commune">Commune :</label>
        <select id="commune" required aria-required="true" aria-label="S√©lectionner la commune" tabindex="0">
          <option value="">-- Choisir une commune --</option>
          <option value="Carcassonne">Carcassonne</option>
          <option value="Narbonne">Narbonne</option>
          <option value="Limoux">Limoux</option>
          <!-- Ajoutez d'autres communes si besoin -->
        </select>

        <label for="type">Type d‚Äô√©v√©nement :</label>
        <select id="type" required aria-required="true" aria-label="S√©lectionner le type d‚Äô√©v√©nement" tabindex="0">
          <option value="">-- Choisir un type d‚Äô√©v√©nement --</option>
          <option value="Police">Contr√¥le de police</option>
          <option value="Accident">Accident</option>
          <option value="Feu">Incendie / Feu</option>
          <option value="Autre">Autre</option>
        </select>

        <label for="infos">Informations compl√©mentaires :</label>
        <textarea
          id="infos"
          name="infos"
          rows="4"
          placeholder="√âcrivez ici des d√©tails ou informations suppl√©mentaires..."
          aria-label="Informations compl√©mentaires"
          tabindex="0"
        ></textarea>

        <button
          type="submit"
          class="button-pro"
          aria-label="Publier l‚Äôalerte"
          tabindex="0"
        >
          üö© Publier l‚Äôalerte
        </button>
      </form>
      <div id="confirmation" role="alert" aria-live="polite" style="display:none;">
        ‚úÖ Merci, votre alerte a bien √©t√© publi√©e !
      </div>
    </div>

    <div
      class="table-section"
      role="region"
      aria-labelledby="table-title"
      aria-live="polite"
      aria-relevant="additions"
    >
      <span id="compteur" aria-live="polite" aria-atomic="true"
        >0 alerte publi√©e</span
      >
      <table id="listeAlertes" summary="Liste des alertes citoyennes publi√©es">
        <thead>
          <tr>
            <th scope="col">Commune</th>
            <th scope="col">Type</th>
            <th scope="col">Date</th>
            <th scope="col">Informations</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div
      style="
        background: #f3f7ff;
        border-left: 4px solid #3498db;
        padding: 12px;
        margin: 24px auto 40px auto;
        max-width: 700px;
        border-radius: 4px;
        font-size: 1rem;
        color: #2c3e50;
      "
      role="note"
      aria-live="polite"
    >
      Ce site permet de publier et consulter des alertes en temps r√©el, simplement et rapidement.
    </div>
  </main>

  <script>
    let totalAlertes = 0;

    function validerAlerte() {
      const commune = document.getElementById("commune").value.trim();
      const type = document.getElementById("type").value.trim();
      const infos = document.getElementById("infos").value.trim();
      if (!commune || !type) {
        alert("Merci de s√©lectionner COMMUNE et TYPE d‚Äô√©v√©nement !");
        return false;
      }
      document.getElementById("confirmation").style.display = "block";
      setTimeout(() => {
        document.getElementById("confirmation").style.display = "none";
      }, 2400);
      ajouterAlerte(commune, type, infos);
      // R√©initialiser les champs
      document.getElementById("commune").value = "";
      document.getElementById("type").value = "";
      document.getElementById("infos").value = "";
      return false;
    }

    function ajouterAlerte(commune, type, infos) {
      const tableBody = document
        .getElementById("listeAlertes")
        .getElementsByTagName("tbody")[0];
      const row = tableBody.insertRow(0);
      const iconMap = {
        Police: "üöì",
        Accident: "‚ö†Ô∏è",
        Feu: "üî•",
        Autre: "üí°",
      };
      const icon = iconMap[type] || "‚ùî";
      row.insertCell(0).innerText = commune;
      row.insertCell(1).innerHTML = icon + " " + type;
      row.insertCell(2).innerText = new Date().toLocaleString();
      row.insertCell(3).innerText = infos || "-";
      totalAlertes++;
      document.getElementById("compteur").innerText =
        totalAlertes + (totalAlertes > 1 ? " alertes publi√©es" : " alerte publi√©e");
    }

    // Mode sombre toggle
    const darkToggle = document.getElementById("darkToggle");
    darkToggle.onclick = function () {
      document.body.classList.toggle("darkmode");
      const isDark = document.body.classList.contains("darkmode");
      this.textContent = isDark ? "‚òÄÔ∏è Mode clair" : "üåô Mode sombre";
      this.setAttribute("aria-pressed", isDark ? "true" : "false");
    };
  </script>
</body>
</html>
